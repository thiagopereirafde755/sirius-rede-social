<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- TITULO DA PAGINA -->
    <title>Procurar usuário</title>
    <!-- ICONES -->
    <link rel="icon" type="image/png" sizes="16x16" href="../static/img/logo/logo_sirius.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../static/img/logo/logo_sirius.png">
    <link rel="icon" type="image/png" sizes="96x96" href="../static/img/logo/logo_sirius.png">
    <link rel="icon" type="image/png" sizes="192x192" href="../static/img/logo/logo_sirius.png">
    <!-- BOXICONS -->
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <!-- CSS DO BOOTSTRAP -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/css/bootstrap.min.css">
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="../static/css/sweealert2.css">
    <!-- STYLES -->
    <link rel="stylesheet" href="../static/css/principal.css">
    <link rel="stylesheet" href="../static/css/post.css">
    <link rel="stylesheet" href="../static/css/procurar-user.css">
    <link rel="stylesheet" href="../static/css/loading.css">
    <!-- BIBLIOTECAS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body class="{{ tema }}">

    <!-- TELA DE CARREGAMENTO -->
    <div id="loadingScreen">
        <img src="../static/img/logo/logo_sirius.png" alt="Logo Sirius" />
    </div>

    <!-- CABEÇALHO MOBILE -->    
    <div class="pesquisa-para-mobile">
        <form action="/procurar-user" method="GET">
            <div class="form-input">
                <input type="search" name="query" placeholder="Procurar usuário..." required>
                <button type="submit" class="search-btn"><i class='bx bx-search'></i></button>
            </div>
        </form>
        <div class="logo" id="logo-no-mobile">
            <i class='bx bxs-dog'></i>
        </div>
    </div>

    <!-- CABEÇALHO DESKTOP -->
    <header class="header">
        <div class="logoSearch">
            <div class="logo" id="logo">
                <i class='bx bxs-dog'></i>
            </div>
             <form action="/procurar-user" method="GET">
                 <div class="form-input" id="pesquisa-pagina">
                     <input type="search" name="query" placeholder="Procurar usuário..." required>
                     <button type="submit" class="search-btn"><i class='bx bx-search'></i></button>
                 </div>
             </form>
        </div>

        <!-- OPÇOES NA PARTE INFERIOR DO MOBILE --> 
        <div class="mobile-header-icons">

            <!-- MINHA FOTO -->
            <div class="minha-foto-mobile">
                <a href="/inicio">
                    <img src="{{foto_perfil}}" id="foto-mobile-header" alt="my-photo">
                </a>
            </div>
            
            <!-- EXPLORAR -->
            <a href="/home">
                <div class="opcao-mobile">
                    <i class='bx bxs-home'></i>
                </div>
            </a>  
            
            <!-- CHAT -->
            <a href="/chat">
                <div class="opcao-mobile">
                    <i class='bx bxs-chat'></i>
                </div>
            </a>

            <!-- VIDEOS -->
            <a href="/post-video">
                <div class="opcao-mobile">
                    <i class='bx bxs-videos'></i>
                </div>
            </a>

            <!-- NOTIFICAÇÃO -->
            <a href="/notificacoes">
                <div class="opcao-mobile">
                    <i class='bx bxs-bell' ></i>
                </div>
            </a>

            <!-- MENU -->
            <div class="opcao-mobile1">
                <i class='bx bx-menu'></i>
            </div>
        </div>
            
        <!-- OPÇOES DO HEADER -->
        <div class="mainMenu">

            <!-- EXPLORAR -->
            <a href="/home">
                <div class="svg">
                    <i class='bx bxs-home'></i>
                </div>
            </a>

            <!-- SEGUINDO -->
            <a href="/post-seguindo">
                <div class="svg">
                    <i class='bx bxs-user'></i>
                </div>
            </a>

            <!-- VIDEOS -->
            <a href="/post-video">
                <div class="svg">
                    <i class='bx bxs-videos'></i>
                </div>
            </a>

            <!-- CURTIDOS -->
            <a href="/post-curtidos">
                <div class="svg">
                    <i class='bx bxs-heart'></i>
                </div>
            </a>
        </div>

        <!-- PERFIL -->
        <a href="/inicio">
            <div class="profileTools">
            <div class="profile">
                <div class="img" style="background-image: url('{{foto_perfil}}');"></div>
                <div class="username">Perfil</div>
            </div>
        </a>

        <div class="tools">

            <!-- NOTIFICAÇOES -->
            <a href="/notificacoes">
                <div class="svg">
                    <i class='bx bxs-bell'></i>
                </div>
            </a>

            <!-- CHAT -->
            <a href="/chat">
                <div class="svg">
                    <i class='bx bxs-chat'></i>
                </div>
            </a>

            <!-- CONFIGURAÇOES -->
            <a href="/configuracao">
                <div class="svg">
                    <i class='bx bxs-cog'></i>
                </div>
            </a>

        </div>
    </header>

    <div class="sidebar-esquerdo">
        <div class="aside-esquerdo-mobile">

            <!-- EXPLORAR -->
            <a href="/home">  
                <div class="globalProfile">
                    <i class='bx bxs-home'></i>
                    <div class="name">Explorar</div>
                </div>
            </a>

            <!-- SEGUINDO -->
            <a href="/post-seguindo">
                <div class="globalProfile">
                    <i class='bx bxs-user'></i>
                    <div class="name">Seguindo</div>
                </div>
            </a>
                
            <!-- VIDEOS -->
            <a href="/post-video">
                <div class="globalProfile">
                    <i class='bx bxs-videos'></i>
                    <div class="name">Videos</div>
                </div>
            </a>

            <!-- CURTIDAS -->
            <a href="/post-curtidos">
                <div class="globalProfile">
                    <i class='bx bxs-heart'></i>
                    <div class="name">Curtidas</div>
                </div>
            </a>

            <!-- REPUBLICADO -->
            <a href="/post-republicados">
                <div class="globalProfile">
                    <i class='bx bx-repost'></i>
                    <div class="name">Republicados</div>
                </div>
            </a>

            <!-- SALVO -->
            <a href="/post-salvo">
                <div class="globalProfile">
                    <i class='bx bxs-bookmark'></i>
                    <div class="name">Salvo</div>
                </div>
            </a>
                
            <!-- PROCURAR USER -->
            <a href="/procurar-user">
                <div class="globalProfile active">
                    <i class='bx bxs-user-plus'></i>
                    <div class="name-active">Procurar</div>
                </div>
            </a>

            <!-- CHAT -->
            <a href="/chat">
                <div class="globalProfile" style="position:relative;">
                    <i class='bx bxs-chat'></i>
                    <div class="name">Mensagem</div>
                    <span class="badge-nao-vistas" id="badge-chat-notify">0</span>
                </div>
            </a>

            <!-- MEU PERFIL -->
            <a href="/inicio">
                <div class="globalProfile">
                    <i class='bx bxs-user'></i>
                    <div class="name">Perfil</div>
                </div>
            </a>

            <!-- NOTIFICAÇÃO -->
            <a href="/notificacoes">
                <div class="globalProfile">
                    <i class='bx bxs-bell'></i>
                    <div class="name">Notificação</div>
                    <span class="badge-nao-vistas" id="badge-notificacao-notify">0</span>
                </div>
            </a>
            
            <!-- CONFIGURAÇÃO -->
            <a href="/configuracao">
                <div class="globalProfile ">
                    <i class='bx bxs-cog'></i>
                    <div class="name">Configuração</div>
                </div>
            </a>

            <!-- SAIR DA CONTA -->
            <a href="#" id="logout-link">
                <div class="globalProfile">
                    <i class='bx bx-log-out'></i>
                    <div class="name">Sair</div>
                </div>
            </a>
        </div>
    </div>

    <!-- ASIDEBAR DIREITO DESKTOP -->
    <div class="sideBarContainer">
        <div class="sidebar left"></div>
        <div class="sidebar right">
            <div class="container borderNone">

                <div class="mainTitle">
                    <h3 class="padding">Meu Perfil</h3>
                </div>
        
                <a href="/inicio">
                    <div class="globalProfile">
                        <div class="globalRoundProfile" style="background-image: url('{{ foto_perfil }}');"></div>
                        <div class="name">{{nome_usuario}}</div>
                    </div>
                </a> 
            </div>

            <div class="container borderNone">
                <div class="mainTitle">
                    <h3 class="padding">Momento</h3>
                </div>

                {% if hashtags_top %}
                    <div class="hashtags-top">
                        {% for hashtag in hashtags_top %}
                            <a href="/pesquisar?query={{ hashtag.nome|urlencode }}" class="hashtag-btn" >
                                <span class="hashtag-nome">
                                    <span class="hashtag-nome-truncado" title="{{ hashtag.nome }}">{{ hashtag.nome }}</span> - {{ hashtag.total | numcurto }}
                                </span>
                            </a>
                        {% endfor %}
                    </div>
                {% else %}
                    <p class="hashtaginfo">Nenhuma hashtag recente.</p>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- ABRIR O SIDEBAR DIREITO MOBILE -->
    <div class="toggle-sidebar-right" id="toggleSidebarRight">
        <i class='bx bx-chevron-left'></i>
    </div>

    <!-- SIDEBAR DIREITO MOBILE -->
    <div class="aside-direito-mobile" id="asideDireitoMobile">
        <div class="container borderNone">
            <div class="mainTitle sem-linha">
                <h3 class="padding">Meu Perfil</h3>
            </div>
            <a href="/inicio">
                <div class="globalProfile">
                    <div class="globalRoundProfile" style="background-image: url('{{ foto_perfil }}');"></div>
                    <div class="name">{{nome_usuario}}</div>
                </div>
            </a> 
        </div>
        <div class="container borderNone">
            <div class="mainTitle linha-momento">
                <h3 class="padding">Momento</h3>
            </div>
            {% if hashtags_top %}
                <div class="hashtags-top">
                    {% for hashtag in hashtags_top %}
                        <a href="/pesquisar?query={{ hashtag.nome|urlencode }}" class="hashtag-btn hashtag-btn-mob" >
                            <span class="hashtag-nome">{{ hashtag.nome }} - {{ hashtag.total | numcurto }}</span>
                        </a>
                    {% endfor %}
                </div>
            {% else %}
                <p class="hashtaginfo-2">Nenhuma hashtag recente.</p>
            {% endif %}
        </div>
    </div>
 
    <main class="sectionCenter">
        <div class="resultados-container">
            {% if query %}
                <a href="/procurar-user" class="limpar-pesquisa">
                    <i class='bx bx-trash'></i> Limpar pesquisa
                </a>
                <div class="titulo-resultados">
                    <b>Resultados da pesquisa: <span class="query-text">{{ query }}</span></b>
                </div>
                {% if resultados %}
                    {% for usuario in resultados %}
                        <div class="resultado-usuario">
                            <a href="#" class="link-perfil"
                                data-id="{{ usuario.id }}"
                                data-url="{{ url_for('info_user.info_user', id_usuario=usuario.id) }}">
                                <img src="{{ usuario.fotos_perfil if usuario.fotos_perfil else url_for('static', filename='img/icone/user.png') }}" alt="{{ usuario.username }}">
                                {{ usuario.username }}
                            </a>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="no-results-wrapper">
                        <div class="no-results-card">
                            <i class='bx bxs-user'></i>
                            <p class="no-results-message">Nenhum usuário encontrado.</p>
                        </div>
                    </div>
                {% endif %}
            {% elif historico %}
                <div class="titulo-resultados"><b>Pesquisas recentes</b></div>
                {% for usuario in historico %}
                    <div class="resultado-usuario">
                        <a href="#" class="link-perfil"
                        data-id="{{ usuario.id }}"
                        data-url="{{ url_for('info_user.info_user', id_usuario=usuario.id) }}">
                            <img src="{{ usuario.fotos_perfil if usuario.fotos_perfil else url_for('static', filename='img/icone/user.png') }}" alt="{{ usuario.username }}">
                            {{ usuario.username }}
                        </a>
                        <form method="POST"
                            action="{{ url_for('procurar_user.remover_historico') }}"
                            style="display:inline">
                            <input type="hidden" name="id_pesquisado" value="{{ usuario.id }}">
                            <button class="remover-x" title="Remover do histórico">
                                <i class='bx bx-x'></i>
                            </button>
                        </form>
                    </div>
                {% endfor %}
            {% else %}
                <div class="no-results-wrapper">
                    <div class="no-results-card">
                        <i class='bx bxs-user'></i>
                        <p class="no-results-message">Pesquise pelo nome de usuário.</p>
                    </div>
                </div>
            {% endif %}
        </div>
    </main>

    <!-- jQuery primeiro -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Slick Carousel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>

    <!-- Bootstrap JS  -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <!-- SCRIPT --> 
    <!-- CONTAS AS MENSAGENS DO CHAT NAO LIDA -->
    <script src="../static/js/geral/contador_novas_mensagens.js"></script>

    <!-- PARA CONTAR AS NOTIFICAÇÕES DO SISTEMA -->
    <script src="../static/js/geral/contador_novas_notificacoes.js"></script> 

    <!-- PARA NOTIFICAR NO NAVEGADOR -->
    <script src="../static/js/notificacao/notificacao.js"></script> 

    <!-- PARA SAIR DA CONTA -->
    <script src="../static/js/sweealert2/log_out.js"></script>

    <!-- PARA O MENU LATERAL ESQUERDO MOBILE -->
    <script src="../static/js/geral/menu_toggle.js"></script>

    <!-- FORMATA A HASHTAG -->
    <script src="../static/js/geral/hashtag.js"></script>

    <!-- PARA SALVAR AS PESQUISA -->
    <script src="../static/js/salvar_historico_pesquisa_usuario.js"></script>

    <!-- FORÇAR O SCROLL -->
    <script src="../static/js/geral/forca_scroll.js"></script>

    <!-- LOADING DA PAGINA -->
    <script src="../static/js/carregamento/loading.js"></script>

    <!-- PARA CHECAR SE A NOTIFICACAO PUSH ESTA ATIVADO -->
    <script src="../static/js/notificacao/check.js"></script>

</body>